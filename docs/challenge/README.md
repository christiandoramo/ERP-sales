# ðŸ’» Desafio TÃ©cnico â€“ Desenvolvedor Fullstack JÃºnior

O Instituto Senai de InovaÃ§Ã£o estÃ¡ em busca de **desenvolvedores com perfil versÃ¡til**, capazes de atuar tanto no **backend quanto no frontend**, para resolver desafios reais e relevantes.  
Este desafio faz parte do nosso processo seletivo para a vaga de **Desenvolvedor Fullstack JÃºnior**.

O objetivo Ã© avaliar sua **habilidade tÃ©cnica**, **clareza de raciocÃ­nio**, **organizaÃ§Ã£o de cÃ³digo** e **capacidade de entregar uma aplicaÃ§Ã£o funcional com base em requisitos enxutos**, algo que acontece com frequÃªncia em projetos de inovaÃ§Ã£o.

Mais do que domÃ­nio tÃ©cnico, valorizamos a **capacidade de pensar de forma estruturada**, escrever **cÃ³digo limpo**, seguir **boas prÃ¡ticas** e tomar **decisÃµes conscientes** durante o desenvolvimento.

---

## âœ… O que esperamos ver no seu projeto

- OrganizaÃ§Ã£o do projeto com **estrutura clara e lÃ³gica**
- Capacidade de construir uma **aplicaÃ§Ã£o funcional**, mesmo com requisitos limitados
- Uso consistente de **boas prÃ¡ticas no frontend e backend**
- Uso de **Git** com histÃ³rico **coerente de commits**

---

## ðŸŒŸ Diferenciais tÃ©cnicos que contam pontos

- **CÃ³digo limpo e legÃ­vel**, seguindo os princÃ­pios do *Clean Code* (nomes significativos, pequenas funÃ§Ãµes, baixo acoplamento, alta coesÃ£o)
- Arquitetura consistente, com **separaÃ§Ã£o clara entre camadas** da aplicaÃ§Ã£o (ex: MVC, DDD)
- **Tratamento de erros** e respostas HTTP padronizadas (mensagens claras e status codes corretos)
- **Testes automatizados** (unitÃ¡rios ou de integraÃ§Ã£o ou E2E) com cobertura mÃ­nima dos fluxos principais â€“ *nÃ£o sÃ£o obrigatÃ³rios, mas contam como diferencial*
- **DocumentaÃ§Ã£o tÃ©cnica** clara no `README.md` explicando o setup, execuÃ§Ã£o e decisÃµes tÃ©cnicas
- Interface com **responsividade bÃ¡sica**, priorizando **usabilidade**
- **Uso de Docker** (`Dockerfile` e/ou `docker-compose`) para facilitar o deploy e garantir portabilidade do ambiente, *nÃ£o Ã© obrigatÃ³rio, mas serÃ¡ considerado um diferencial*
- **Uso consciente de bibliotecas externas** com explicaÃ§Ãµes, quando necessÃ¡rio, das escolhas de dependÃªncia

---

## O que serÃ¡ avaliado

| CritÃ©rioÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | PesoÂ Â Â  |
|-----------------------------------------------|---------|
| Estrutura e organizaÃ§Ã£o do projetoÂ Â Â Â Â Â Â Â Â Â Â  | â˜…â˜…â˜…â˜…â˜… |
| AplicaÃ§Ã£o correta das regras de negÃ³cioÂ Â Â Â Â Â  | â˜…â˜…â˜…â˜…â˜† |
| Clareza e limpeza do cÃ³digoÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | â˜…â˜…â˜…â˜…â˜† |
| Tratamento de errosÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | â˜…â˜…â˜…â˜†â˜† |
| README tÃ©cnico completoÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | â˜…â˜…â˜…â˜…â˜† |
| Git com granularidade e histÃ³rico limpoÂ Â Â Â Â Â  | â˜…â˜…â˜…â˜†â˜† |
| AderÃªncia a padrÃµes REST e boas prÃ¡ticas HTTP | â˜…â˜…â˜…â˜†â˜† |
| ExperiÃªncia do UsuÃ¡rio (Frontend)Â Â Â Â Â Â Â Â Â Â Â Â  | â˜…â˜…â˜…â˜…â˜† |

## ðŸŽ¯ Objetivo

Este desafio tÃ©cnico tem como propÃ³sito simular um fluxo real de vendas dentro de um ambiente corporativo, focando no cadastro, listagem, ediÃ§Ã£o e gerenciamento de produtos, bem como na aplicaÃ§Ã£o de descontos com regras de negÃ³cio rigorosas e realistas. A ideia Ã© proporcionar uma experiÃªncia prÃ³xima da realidade de sistemas de e-commerce ou ERPs modernos, exigindo atenÃ§Ã£o aos detalhes, domÃ­nio de boas prÃ¡ticas de desenvolvimento e compreensÃ£o sÃ³lida de integraÃ§Ãµes e processos de validaÃ§Ã£o.

VocÃª serÃ¡ responsÃ¡vel por desenvolver uma aplicaÃ§Ã£o web fullstack, contemplando as seguintes funcionalidades principais:

- Cadastro de produtos com controle de **preÃ§o**, **estoque** e **unicidade de nome**
- Listagem de produtos com **filtros avanÃ§ados** e **paginaÃ§Ã£o**
- AplicaÃ§Ã£o e remoÃ§Ã£o de **descontos percentuais** ou **cupons promocionais**, seguindo regras especÃ­ficas de negÃ³cio

A proposta visa nÃ£o apenas testar a sua capacidade tÃ©cnica e organizaÃ§Ã£o de projeto, mas tambÃ©m avaliar sua sensibilidade Ã s regras de negÃ³cio, tratamento de exceÃ§Ãµes e comportamento frente a requisitos ambÃ­guos ou propensos a falhas. Essa simulaÃ§Ã£o aproxima-se dos desafios enfrentados por times de desenvolvimento que lidam com fluxos reais de negÃ³cio em empresas que prezam pela confiabilidade e manutenÃ§Ã£o da lÃ³gica da aplicaÃ§Ã£o ao longo do tempo.

## Â ðŸ§­ Stack MÃ­nima Sugerida

### Backend

- [NestJS](https://nestjs.com): framework moderno e escalÃ¡vel que utiliza TypeScript por padrÃ£o e favorece uma arquitetura modular.  
- [Express.js](https://expressjs.com): framework web minimalista e flexÃ­vel, bastante difundido para criaÃ§Ã£o de APIs REST com Node.js.

**ObservaÃ§Ã£o:** TambÃ©m Ã© permitida a utilizaÃ§Ã£o de outras linguagens, como Java com Spring Boot, desde que a arquitetura web REST seja mantida e os requisitos sejam atendidos.

---

### Frontend

- **Biblioteca Base:** [ReactJS](https://react.dev)  
  Preferencialmente, utilize [ReactJS](https://react.dev), com ou sem frameworks adicionais. Esperamos a construÃ§Ã£o de **componentes reutilizÃ¡veis**, aplicaÃ§Ã£o de um **controle de estado simples** com `useState`, `useEffect`, e, se necessÃ¡rio, [Context API](https://react.dev/learn/passing-data-deeply-with-context) para compartilhamento de estado global.

  A integraÃ§Ã£o com a API backend deve ser clara, funcional e bem organizada (ex.: fetch/axios com tratamento de loading e erro).

- **Liberdade de Framework:**  
  VocÃª tem **liberdade para utilizar frameworks baseados em React**, como:  
  - [Next.js](https://nextjs.org): oferece roteamento baseado em arquivos, SSR, SSG e Ã³timo suporte a SEO.  
  - [Remix](https://remix.run): traz uma abordagem centrada em rotas, com carregamento de dados no servidor, ideal para experiÃªncias rÃ¡pidas e declarativas.

  Ambos sÃ£o bem-vindos e aceitos neste desafio, desde que o projeto mantenha **clareza arquitetural, organizaÃ§Ã£o e cobertura dos requisitos funcionais**.

- **Liberdade de Biblioteca de Estado:**  
  TambÃ©m Ã© permitido utilizar a biblioteca de gerenciamento de estado de sua preferÃªncia, como:
  - [Zustand](https://zustand-demo.pmnd.rs/)
  - [Redux](https://redux.js.org/)
  - [Jotai](https://jotai.org/)
  - [Recoil](https://recoiljs.org/)
  - Ou outras de sua escolha

  O mais importante Ã© que a implementaÃ§Ã£o seja **bem estruturada, compreensÃ­vel e adequada Ã  complexidade da aplicaÃ§Ã£o**.

- **Outras Bibliotecas/Frameworks:**  
  Frameworks modernos como Vue.js ou Angular tambÃ©m sÃ£o aceitos, desde que respeitem a arquitetura proposta e cumpram todos os requisitos funcionais com clareza.

### Â  Banco de Dados

- **Tipo:** Relacional em memÃ³ria ou Relacional
- **Exemplo:** SQLite utilizando `':memory:'` como caminho para rodar totalmente em memÃ³ria.

**Alternativas Aceitas:**

- **H2** ou **HSQLDB** (para implementaÃ§Ãµes em Java)  
- [`better-sqlite3`](https://github.com/WiseLibs/better-sqlite3) no Node.js (com suporte a `':memory:'`)  
- Qualquer outro banco relacional leve, desde que mantenha a **persistÃªncia temporÃ¡ria ou fixa** (Postgres, MySQL) e seja fÃ¡cil de configurar para fins de teste e demonstraÃ§Ã£o

## Backend

### MÃ³dulo: Produtos e Descontos

VocÃª deverÃ¡ criar:

- **Backend com API RESTful** para produtos e cupons, incluindo:
  - Endpoints para **criaÃ§Ã£o**, **ediÃ§Ã£o**, **inativaÃ§Ã£o** (soft delete) e **listagem paginada** de produtos
  - Endpoints para **aplicar e remover descontos percentuais** e **cupons promocionais**
  - **ValidaÃ§Ãµes de unicidade**, integridade referencial e regras especÃ­ficas de negÃ³cio

- **Frontend funcional**, contendo:
  - Listagem de produtos com **paginaÃ§Ã£o**, **busca** e **filtros** (nome, faixa de preÃ§o, com ou sem desconto)
  - **FormulÃ¡rio de cadastro e ediÃ§Ã£o** de produtos (com suporte a atualizaÃ§Ã£o via patch)
  - Interface para **aplicar e remover cupons/descontos**, com **feedback visual claro**
  - **Destaques visuais** para produtos com estoque zerado ou com desconto ativo

- **ValidaÃ§Ãµes robustas**, cobrindo:
  - **Formatos de preÃ§o**, normalizaÃ§Ã£o de nome e restriÃ§Ãµes de valor
  - PrevenÃ§Ã£o Ã  **aplicaÃ§Ã£o mÃºltipla de descontos** no mesmo produto
  - RejeiÃ§Ã£o de **cupons invÃ¡lidos, expirados** ou que resultem em valor final **abaixo de R$ 0,01**
  - Retorno de **cÃ³digos HTTP apropriados** para erros esperados (`422`, `409`, `412`, entre outros)

## ðŸš¨ Funcionalidades ObrigatÃ³rias

### Listagem de Produtos

Deve ser possÃ­vel:

- Visualizar uma tabela com as colunas:
  - Nome
  - DescriÃ§Ã£o
  - Estoque atual
  - PreÃ§o original
  - PreÃ§o com desconto (se aplicÃ¡vel)
- Exibir badges ou indicadores visuais para:
  - Produtos com desconto ativo
  - Produtos com estoque zerado
- Filtrar produtos por:
  - Nome (busca textual)
  - Faixa de preÃ§o (mÃ­nimo e mÃ¡ximo)
  - Com ou sem desconto ativo (booleano)
- Paginar os resultados com paginaÃ§Ã£o padrÃ£o de **10 por pÃ¡gina**

## ðŸ§¾ Query Params Aceitos

Os seguintes parÃ¢metros podem ser utilizados para refinar a listagem de produtos:

- **`page`** (`integer â‰¥ 1`): nÃºmero da pÃ¡gina atual.
- **`limit`** (`integer`, entre 1 e 50): quantidade de itens por pÃ¡gina.
- **`search`** (`string`): busca textual no nome ou descriÃ§Ã£o do produto.
- **`minPrice` / `maxPrice`** (`decimal`): filtro por faixa de preÃ§o mÃ­nima e mÃ¡xima.
- **`hasDiscount`** (`boolean`): `true` ou `false` para filtrar produtos com ou sem desconto.
- **`sortBy`** (`string`): campo para ordenaÃ§Ã£o. Valores possÃ­veis: `name`, `price`, `created_at`, `stock`.
- **`sortOrder`** (`string`): direÃ§Ã£o da ordenaÃ§Ã£o. Pode ser `asc` ou `desc`.
- **`includeDeleted`** (`boolean`): se `true`, inclui produtos inativos (soft deleted). Recomendado apenas para administradores.
- **`onlyOutOfStock`** (`boolean`): se `true`, retorna apenas produtos com estoque igual a zero.
- **`withCouponApplied`** (`boolean`): se `true`, retorna apenas produtos que possuem cupom promocional aplicado.

#### Requisitos Adicionais

- Garantir que a ordenaÃ§Ã£o por **nome**, **preÃ§o** e **estoque** seja suportada em ambas as direÃ§Ãµes (`asc` e `desc`).
- Retornar resposta **`200 OK`** com uma **lista vazia** caso nenhuma correspondÃªncia seja encontrada.
- Adotar comportamento consistente de **paginaÃ§Ã£o**, mesmo quando nÃ£o houver resultados.  
  Exemplo: se `page=10` nÃ£o possui itens, ainda assim deve retornar um array vazio com os metadados corretos (`page`, `limit`, `totalItems`, `totalPages`).

### Cadastro de Produto

O cadastro de produtos deve ser feito com especial atenÃ§Ã£o Ã s validaÃ§Ãµes de regras de negÃ³cio, estrutura dos campos e consistÃªncia dos dados. A aplicaÃ§Ã£o deverÃ¡ ser robusta o suficiente para impedir erros simples e respeitar todas as regras de domÃ­nio.

#### Campos obrigatÃ³rios

- **`name`** (string, obrigatÃ³rio)  
  - Deve ser Ãºnico apÃ³s normalizaÃ§Ã£o (remover espaÃ§os duplicados)  
  - MÃ­nimo: 3 caracteres  
  - MÃ¡ximo: 100 caracteres  
  - Regex recomendado: `^[a-zA-Z0-9\s\-_,.]+$`  

- **`description`** (string, opcional)  
  - MÃ¡ximo: 300 caracteres  

- **`stock`** (integer, obrigatÃ³rio)  
  - Valor mÃ­nimo: 0  
  - Valor mÃ¡ximo: 999999  

- **`price`** (decimal, obrigatÃ³rio)  
  - MÃ­nimo: 0.01  
  - MÃ¡ximo: 1.000.000,00  
  - Deve aceitar formatos brasileiros (ex: "1.234,56") e internacionais (ex: 1234.56), mas ser persistido corretamente como decimal  

- **`created_at`** (ISODate, obrigatÃ³rio)  
  - Deve ser preenchido com a data/hora atual no momento do cadastro  
  - Deve ser imutÃ¡vel apÃ³s criaÃ§Ã£o  
  - Deve estar no passado ou presente (nunca no futuro)

#### Regras obrigatÃ³rias

- O campo **`name`** deve ser Ãºnico no banco mesmo apÃ³s normalizaÃ§Ã£o.  
- Produtos com **`stock == 0`** devem ser destacados na listagem com um badge visual **"Esgotado"**.  
- O valor original nunca deve ser alterado por descontos. Os **descontos devem ser armazenados separadamente**.  
- O **valor com desconto** (se houver) deve ser sempre **recalculado dinamicamente** e **nÃ£o salvo** de forma persistente no banco.  
- Ã‰ proibido criar produtos com o **preÃ§o com desconto menor que R$ 0,01**.  
- O campo **`created_at`** deve refletir corretamente a **data/hora da criaÃ§Ã£o** e **nÃ£o pode ser editado posteriormente**.  
- Adicionar o campo **`updated_at`** para rastrear modificaÃ§Ãµes (**opcional, mas recomendado**).

### AplicaÃ§Ã£o de Descontos

#### Tipos permitidos

- **Desconto percentual direto:**  
  O produto pode receber um **desconto percentual**, aplicado diretamente sobre o valor original.  
  - O valor do desconto deve estar entre **1% e 80%**.  
  - O cÃ¡lculo do valor final deve ser feito de forma dinÃ¢mica no momento da exibiÃ§Ã£o da tabela.  
  - Este tipo de desconto nÃ£o requer cÃ³digo promocional e Ã© aplicado automaticamente conforme regras do sistema (ex: campanhas sazonais, queima de estoque etc.).

- **Cupom promocional:**  
  O sistema deve permitir a aplicaÃ§Ã£o de **cupons promocionais**, que podem ser de dois tipos:  
  - **fixed** (ex: R$ 50 de desconto)  
  - **percent** (ex: 10%, 25% etc.)

  Os cupons devem ser **previamente cadastrados no sistema** e conter:  
  - Um **cÃ³digo Ãºnico identificador**, como `PROMO10`, `QUERO25`, etc.  
  - Uma regra de validade (data de expiraÃ§Ã£o ou quantidade de usos).  
  - Um tipo (fixed ou percent) e valor correspondente.  
  - AplicaÃ§Ã£o dinÃ¢mica no checkout, sem persistÃªncia do valor com desconto.

  > âš ï¸ Ã‰ responsabilidade do sistema validar se o cupom Ã© vÃ¡lido, aplicÃ¡vel ao produto, e se respeita os limites mÃ­nimos de valor final (por exemplo, nÃ£o permitir que o produto fique abaixo de R$ 0,01).

#### Regras

- **Apenas um Ãºnico desconto pode estar ativo por produto.**  
  Caso jÃ¡ exista um desconto aplicado (seja percentual ou via cupom), a tentativa de aplicar outro deve resultar em erro **`409 Conflict`**.

- **ValidaÃ§Ãµes para cupons promocionais**  
  Todo cupom promocional deve conter os seguintes campos e validaÃ§Ãµes obrigatÃ³rias:

  - **`code`** (string, obrigatÃ³ria e Ãºnica)  
    - Deve ter entre **4 e 20 caracteres**  
    - Apenas **caracteres alfanumÃ©ricos** (sem sÃ­mbolos especiais)  
    - **Sem espaÃ§os**  
    - Deve ser **normalizado**: remover acentos, converter para lowercase  
    - CÃ³digos reservados como `admin`, `auth`, `null`, `undefined` devem ser **rejeitados**  
    - Deve ser **Ãºnico no banco**, considerando a versÃ£o normalizada do cÃ³digo  

  - **`type`** (`fixed` ou `percent`)  
    - Campo **obrigatÃ³rio**  
    - Somente os valores **`fixed`** ou **`percent`** sÃ£o aceitos  
    - Qualquer outro valor deve gerar erro **`400 Bad Request`**  

  - **`value`** (nÃºmero, obrigatÃ³rio)  
    - Se **`type == percent`**, o valor deve estar entre **1 e 80**  
    - Se **`type == fixed`**, o valor monetÃ¡rio deve ser **positivo** (ex: R$ 10.00)  

  - **`oneShot`** (booleano, obrigatÃ³rio)  
    - Se **`true`**, o cupom pode ser usado **apenas uma vez por produto**  
    - AplicaÃ§Ãµes repetidas do mesmo cupom no mesmo produto devem retornar **`409 Conflict`**  

  - **`valid_from`** / **`valid_until`** (datas ISO, obrigatÃ³rias)  
    - **`valid_from`** define a data/hora em que o cupom se torna vÃ¡lido  
    - **`valid_until`** define a data limite de validade do cupom  
    - A **data atual** deve estar **entre `valid_from` e `valid_until`** para que o cupom seja aceito  
    - O valor de **`valid_until` deve ser maior que `valid_from`**  
    - A validade mÃ¡xima permitida para cupons Ã© de **5 anos** a partir de `valid_from`

#### Regras adicionais

- Cupons **fora da janela de validade** (ou seja, com a data atual anterior a `valid_from` ou posterior a `valid_until`) devem ser **rejeitados com erro `400 Bad Request`**.

- Cupons que resultem em um **preÃ§o final inferior a R$ 0,01** devem ser **rejeitados com erro `422 Unprocessable Entity`**.  
  Essa validaÃ§Ã£o deve ocorrer **antes da persistÃªncia** e impedir a conclusÃ£o da operaÃ§Ã£o.

- A **aplicaÃ§Ã£o de descontos** (seja percentual ou por cupom) deve ocorrer de forma **transacional**.  
  Ou seja, o cupom, o vÃ­nculo ao produto e o cÃ¡lculo do valor com desconto devem ser tratados como uma Ãºnica operaÃ§Ã£o atÃ´mica evitando estados inconsistentes no banco de dados.

- A **remoÃ§Ã£o de um desconto** (cancelamento ou expiraÃ§Ã£o) deve **restaurar automaticamente o valor original** do produto na exibiÃ§Ã£o.  
  Importante: o campo **`price`** deve **sempre manter o valor original** do produto, o valor com desconto nunca deve ser salvo diretamente nesse campo.

## DocumentaÃ§Ã£o dos principais endpoints

> âš ï¸ Esta documentaÃ§Ã£o apresenta uma **sugestÃ£o de estrutura para os endpoints da API**.  
> Ela serve como base para implementaÃ§Ã£o e validaÃ§Ã£o dos requisitos funcionais descritos no desafio.  
> AdaptaÃ§Ãµes podem ser feitas conforme a arquitetura adotada, desde que respeitem os princÃ­pios RESTful e garantam clareza e consistÃªncia no uso da API.

Base URL: `/api/v1`
Todos os exemplos usam JSON. Datas em ISO-8601 (UTC).

### 2.1 Produtos

| MÃ©todo & RotaÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | DescriÃ§Ã£oÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | Status codes principais |
|-----------------------------------|---------------------------------------|-------------------------|
| `GET /products`Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | Lista paginada com filtros avanÃ§ados. | 200Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| `GET /products/{id}`Â Â Â Â Â Â Â Â Â Â Â Â Â  | Detalhes de um produto.Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | 200, 404Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| `POST /products`Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | Cria produto.Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | 201, 400, 409Â Â Â Â Â Â Â Â Â Â  |
| `PATCH /products/{id}`Â Â Â Â Â Â Â Â Â Â Â  | AtualizaÃ§Ã£o parcial via JSON Patch;Â Â  | 200, 400, 404, 412Â Â Â Â Â  |
| `DELETE /products/{id}`Â Â Â Â Â Â Â Â Â Â  | Inativa (soft-delete) o produto.Â Â Â Â Â  | 204, 404Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| `POST /products/{id}/restore`Â Â Â Â  | Restaura produto inativo.Â Â Â Â Â Â Â Â Â Â Â Â  | 200, 404Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| `POST /products/{id}/discount/percent` | Aplica desconto percentual.Â Â Â Â Â Â Â Â Â Â  | 200, 400, 409, 422Â Â Â Â Â  |
| `POST /products/{id}/discount/coupon`Â  | Aplica cupom promocional.Â Â Â Â Â Â Â Â Â Â Â Â  | 200, 400, 404, 409, 422 |
| `DELETE /products/{id}/discount`Â  | Remove desconto ativo.Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | 204, 404Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |

#### 2.1.1 GET /products

```
GET /api/v1/products?page=1&limit=10&search=cafe&minPrice=100&hasDiscount=true
Accept: application/json
```

Query params: `page`, `limit`, `search`, `minPrice`, `maxPrice`, `hasDiscount`, `sortBy`, `sortOrder`, `includeDeleted`, `onlyOutOfStock`, `withCouponApplied`

```json
{
  "page": 1,
  "limit": 10,
  "search": "cafe",
  "minPrice": 100,
  "maxPrice": 1000,
  "hasDiscount": true,
  "sortBy": "name",
  "sortOrder": "asc",
  "includeDeleted": false,
  "onlyOutOfStock": false,
  "withCouponApplied": false
}
```

Exemplo de Resposta 200

```json
{
  "data": [
    {
      "id": 42,
      "name": "CafÃ© Premium",
      "description": "100% arÃ¡bica",
      "stock": 3,
      "is_out_of_stock": false,
      "price": 2590,
      "finalPrice": 2201,
      "discount": {
        "type": "percent",
        "value": 15,
        "applied_at": "2025-06-04T18:15:21Z"
      },
      "hasCouponApplied": true,
      "created_at": "2025-05-30T12:00:00Z",
      "updated_at": "2025-06-01T09:20:05Z"
    }
  ],
  "meta": {
    "page": 1,
    "limit": 10,
    "totalItems": 1,
    "totalPages": 1
  }
}
```

##### ObservaÃ§Ãµes

- `discount` deve ser `null` quando nÃ£o houver desconto ativo ou se o desconto estiver expirado.
- Produtos inativos sÃ³ devem aparecer na listagem se o parÃ¢metro `includeDeleted=true` for utilizado.

#### 2.1.2 POST /products

```
POST /api/v1/products
Content-Type: application/json
```

```json
{
  "name": "CafÃ© Premium",
  "description": "100% arÃ¡bica",
  "stock": 250,
  "price": 2590
}
```

Cria produto e devolve cabeÃ§alho `Location: /products/{id}`.

**Erros**

- `400 Bad Request` â€“ Corpo da requisiÃ§Ã£o invÃ¡lido, falha na regex, preÃ§o negativo, campo `created_at` com data futura, entre outros erros de validaÃ§Ã£o.
- `409 Conflict` â€“ Nome duplicado no banco de dados apÃ³s normalizaÃ§Ã£o (remoÃ§Ã£o de acentos, espaÃ§os extras, conversÃ£o para lowercase).

#### 2.1.3 PATCH /products/{id}

CabeÃ§alho obrigatÃ³rio:
`Content-Type: application/json-patch+json`

Exemplo de patch:

```json
[
  { "op": "replace", "path": "/stock", "value": 300 },
  { "op": "replace", "path": "/price", "value": 2790 }
]
```

### 2.2 Cupons

| MÃ©todo & RotaÂ Â Â Â Â Â  | DescriÃ§Ã£oÂ Â Â Â Â Â Â Â Â Â  |
|---------------------|---------------------|
| `GET /coupons`Â Â Â Â Â  | Lista / busca cÃ³digos. |
| `POST /coupons`Â Â Â Â  | Cria cupom.Â Â Â Â Â Â Â Â  |
| `GET /coupons/{code}` | Detalhes de cupom.Â  |
| `PATCH /coupons/{code}`| Edita (exceto code).|
| `DELETE /coupons/{code}`| Inativa cupom.Â Â Â Â Â  |

#### Modelo de cupom

```json
{
  "code": "promo10",
  "type": "percent",
  "value": 10,
  "oneShot": false,
  "valid_from": "2025-06-01T00:00:00Z",
  "valid_until": "2027-06-01T00:00:00Z"
}
```

#### ValidaÃ§Ãµes

- O campo `code` deve ser **Ãºnico** apÃ³s **normalizaÃ§Ã£o** (remoÃ§Ã£o de acentos, conversÃ£o para lowercase e remoÃ§Ã£o de espaÃ§os).
- O campo `type` deve estar contido no conjunto `{ "fixed", "percent" }`.
- O campo `value` deve respeitar:
  - Para `type = "percent"`: valor entre **1 e 80**.
  - Para `type = "fixed"`: valor **monetÃ¡rio positivo** (maior que 0).
- O campo `valid_until` deve ser uma data **posterior a `valid_from`** e com no mÃ¡ximo **5 anos de diferenÃ§a** entre elas.

### 2.3 CÃ³digos de erro globais

| CÃ³digoÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | Quando ocorreÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
|--------------------------|-----------------------------------------------------------------------------------------------------------|
| 400 Bad RequestÂ Â Â Â Â Â Â Â Â  | ViolaÃ§Ã£o de validaÃ§Ã£o; campo imutÃ¡vel; cupom expirado ou ainda nÃ£o vÃ¡lido.Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| 409 ConflictÂ Â Â Â Â Â Â Â Â Â Â Â  | Tentar cadastrar nome normalizado jÃ¡ existente; aplicar segundo desconto; cupom oneShot reutilizado.Â Â Â Â Â  |
| 422 Unprocessable Entity | Desconto faz preÃ§o cair < R$ 0,01.Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| 404 Not FoundÂ Â Â Â Â Â Â Â Â Â Â  | Recurso inexistente ou inativo sem `includeDeleted=true`.Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| 500 Internal Server Error| Falha inesperada (transaÃ§Ã£o revertida).Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |

### 2.4 Estrutura de Tabelas Sugeridas

A modelagem relacional proposta inclui trÃªs tabelas principais:

### Â  `products` (Produtos)

| Campo         | Tipo      | DescriÃ§Ã£o                                          |
|---------------|-----------|----------------------------------------------------|
| `id`          | INTEGER   | Identificador Ãºnico do produto (PK).               |
| `name`        | STRING    | Nome do produto.                                   |
| `description` | STRING    | DescriÃ§Ã£o do produto (opcional, atÃ© 300 caracteres). |
| `price`       | DECIMAL   | PreÃ§o original (mÃ­nimo 0,01; formato decimal).     |
| `stock`       | INTEGER   | Quantidade disponÃ­vel em estoque (0 a 999 999).    |
| `created_at`  | DATETIME  | Timestamp de criaÃ§Ã£o (nÃ£o editÃ¡vel).               |
| `updated_at`  | DATETIME  | Timestamp da Ãºltima atualizaÃ§Ã£o (opcional).        |
| `deleted_at`  | DATETIME  | Timestamp de inativaÃ§Ã£o soft-delete (opcional).    |

---

###   `coupons` (Cupons de Desconto)

| Campo          | Tipo      | DescriÃ§Ã£o                                                                                         |
|----------------|-----------|---------------------------------------------------------------------------------------------------|
| `id`           | INTEGER   | Identificador Ãºnico do cupom (PK).                                                                |
| `code`         | STRING    | CÃ³digo Ãºnico do cupom (ex: `"SAVE10"`). Deve ser normalizado (lowercase, sem acentos ou espaÃ§os). |
| `type`         | ENUM      | Tipo de desconto: `"percent"` ou `"fixed"`.                                                       |
| `value`        | DECIMAL   | Valor do desconto:<br>- Percentual: `1â€“80` (para 1% a 80%)<br>- Fixo: valor monetÃ¡rio (> 0).       |
| `one_shot`     | BOOLEAN   | Se `true`, sÃ³ pode ser usado uma Ãºnica vez por produto.                                           |
| `max_uses`     | INTEGER   | NÃºmero mÃ¡ximo de usos permitidos (quando `one_shot = false`).                                      |
| `uses_count`   | INTEGER   | Contador de quantas vezes o cupom jÃ¡ foi aplicado.                                                |
| `valid_from`   | DATETIME  | Data/hora em que o cupom se torna vÃ¡lido.                                                         |
| `valid_until`  | DATETIME  | Data/hora de expiraÃ§Ã£o do cupom (mÃ¡x. 5 anos apÃ³s `valid_from`).                                  |
| `created_at`   | DATETIME  | Timestamp de criaÃ§Ã£o (nÃ£o editÃ¡vel).                                                              |
| `updated_at`   | DATETIME  | Timestamp da Ãºltima atualizaÃ§Ã£o (opcional).                                                       |
| `deleted_at`   | DATETIME  | Timestamp de inativaÃ§Ã£o soft-delete (opcional).                                                   |

---

### `product_coupon_applications` (RelaÃ§Ã£o Produto â†” Cupom Aplicado)

Tabela responsÃ¡vel por registrar a **aplicaÃ§Ã£o de um cupom promocional** a um produto.  
Cada produto pode ter **no mÃ¡ximo um cupom aplicado por vez**.  
Essa estrutura garante o controle transacional da aplicaÃ§Ã£o e remoÃ§Ã£o de descontos, respeitando a regra de exclusividade.

| Campo          | Tipo      | DescriÃ§Ã£o                                                         |
|----------------|-----------|-------------------------------------------------------------------|
| `id`           | INTEGER   | Identificador Ãºnico da aplicaÃ§Ã£o (PK).                            |
| `product_id`   | INTEGER   | Chave estrangeira para `products.id`.                             |
| `coupon_id`    | INTEGER   | Chave estrangeira para `coupons.id`.                              |
| `applied_at`   | TIMESTAMP | Data/hora da aplicaÃ§Ã£o do cupom (ISO 8601 UTC).                  |
| `removed_at`   | TIMESTAMP | Data/hora da remoÃ§Ã£o do cupom (nulo enquanto ativo).             |

**Regras adicionais:**

- Um produto pode ter **apenas um registro ativo por vez** (`removed_at IS NULL`).
- A tentativa de aplicar um novo cupom enquanto outro estiver ativo deve resultar em **erro `409 Conflict`**.
- A aplicaÃ§Ã£o e remoÃ§Ã£o devem ocorrer de forma **transacional**, garantindo consistÃªncia.
- ApÃ³s remoÃ§Ã£o, o sistema deve exibir o valor original (`price`) do produto, sem alterar permanentemente seu valor base.

## Fluxo Ideal de Uso: Cadastro de Produto com Cupom e RemoÃ§Ã£o de Desconto

Este fluxo representa o caminho ideal de uso da aplicaÃ§Ã£o, cobrindo o cadastro de produto, criaÃ§Ã£o e aplicaÃ§Ã£o de cupom de desconto, consulta do produto com desconto aplicado e remoÃ§Ã£o do desconto.

### ðŸ§© Passo a Passo

1. **Criar um produto**
   - `POST /products`
   - Exemplo: cria um produto chamado **"CafÃ©"**, que serÃ¡ retornado com `id = 42`.

2. **Cadastrar um cupom de desconto**
   - `POST /coupons`
   - Exemplo: cria um cupom com o cÃ³digo `"promo15"`.

3. **Aplicar o cupom ao produto**
   - `POST /products/42/discount/coupon`
   - Corpo da requisiÃ§Ã£o (JSON):

     ```json
     {
       "code": "promo15"
     }
     ```

   - Resultado: o produto passa a exibir o preÃ§o com o desconto aplicado, conforme as regras definidas pelo cupom.

4. **Consultar o produto com o desconto aplicado**
Â Â  - `GET /products/42`Â  
Â Â  - A resposta inclui uma seÃ§Ã£o `discount`, com detalhes do desconto atual.

5. **Remover o desconto aplicado**
Â Â  - `DELETE /products/42/discount`Â  
Â Â  - O preÃ§o do produto volta ao valor original, sem desconto.

```mermaid
sequenceDiagram
  participant UsuÃ¡rio
  participant Frontend
  participant API
  participant Banco

  UsuÃ¡rio->>Frontend: Digita cÃ³digo do cupom
  Frontend->>API: POST /products/42/discount/coupon\n{ "code": "promo15" }

  API->>Banco: Valida existÃªncia do produto
  Banco-->>API: Produto encontrado

  API->>Banco: Verifica cupom por cÃ³digo
  Banco-->>API: Cupom vÃ¡lido retornado

  API->>Banco: Verifica se jÃ¡ existe desconto ativo
  Banco-->>API: Nenhum desconto aplicado

  API->>Banco: Valida datas (valid_from/valid_until)
  Banco-->>API: Cupom estÃ¡ dentro do perÃ­odo vÃ¡lido

  API->>Banco: Aplica cupom e registra applied_at
  Banco-->>API: AtualizaÃ§Ã£o realizada com sucesso

  API-->>Frontend: 200 OK\nCupom aplicado com sucesso
  Frontend-->>UsuÃ¡rio: Feedback visual de sucesso
```

> ðŸ’¡ Os passos de 2 a 5 podem ser encapsulados em uma mesma transaÃ§Ã£o caso seja necessÃ¡rio garantir **consistÃªncia transacional**.

## Frontend

A interface do sistema deve ser desenvolvida com base no **mockup de referÃªncia** apresentado abaixo.  
Embora **nÃ£o seja necessÃ¡rio seguir o design com precisÃ£o pixel a pixel**, espera-se que o **fluxo de interaÃ§Ã£o, a disposiÃ§Ã£o dos elementos e a estrutura geral da tela** (ex: tabela, filtros, botÃµes) sejam respeitados e reflitam a proposta visual fornecida.

VocÃª tem **total liberdade para escolher a biblioteca ou framework de frontend** que preferir.  
SerÃ¡ dada preferÃªncia para implementaÃ§Ãµes em [ReactJS](https://react.dev), mas qualquer soluÃ§Ã£o moderna que atenda aos requisitos funcionais serÃ¡ aceita.

### Exemplos de bibliotecas e frameworks aceitos

- [ReactJS](https://react.dev)
- [Next.js](https://nextjs.org)
- [Remix](https://remix.run)
- [Vue.js](https://vuejs.org)

### Exemplos de bibliotecas de UI e estilizaÃ§Ã£o

- [TailwindCSS](https://tailwindcss.com)
- [Shadcn/UI](https://ui.shadcn.com)
- [Material UI](https://mui.com)
- [Chakra UI](https://chakra-ui.com)
- [Bootstrap](https://getbootstrap.com)
- CSS tradicional, SCSS, ou soluÃ§Ãµes CSS-in-JS como [styled-components](https://styled-components.com) e [Emotion](https://emotion.sh)

### Bibliotecas de gerenciamento de estado (opcionais)

VocÃª pode utilizar qualquer biblioteca para gerenciar o estado da aplicaÃ§Ã£o, conforme sua familiaridade ou necessidade do projeto. Exemplos:

- [Redux Toolkit](https://redux-toolkit.js.org)
- [Zustand](https://zustand-demo.pmnd.rs)
- [Jotai](https://jotai.org)
- [Recoil](https://recoiljs.org)
- [Context API (nativo do React)](https://react.dev/learn/passing-data-deeply-with-context)

### Bibliotecas auxiliares (opcionais)

Ã‰ permitido o uso de bibliotecas que otimizem a manipulaÃ§Ã£o de formulÃ¡rios, chamadas assÃ­ncronas e validaÃ§Ãµes, desde que **seu uso seja justificado** tecnicamente no projeto. Exemplos:

- [React Hook Form](https://react-hook-form.com) â€” gerenciamento eficiente de formulÃ¡rios com integraÃ§Ã£o a validaÃ§Ãµes
- [React Query](https://tanstack.com/query/latest) â€” para controle de estados de requisiÃ§Ã£o, cache e sincronizaÃ§Ã£o com servidor
- [Axios](https://axios-http.com) ou `fetch` para chamadas HTTP
- [Formik](https://formik.org) â€” alternativa para controle de formulÃ¡rios
- [Yup](https://github.com/jquense/yup) ou [Zod](https://zod.dev) â€” para validaÃ§Ã£o de schemas de dados

> ðŸ’¡ Ao Utilize essas bibliotecas, informe a necessidade ou motivo por exemplo no README, para que possamos entender a necessidade do uso dessa ou de qualquer outra lib.

---

### ðŸŽ¯ Objetivo do Frontend

O objetivo principal da interface Ã© entregar uma experiÃªncia de uso fluida, clara e funcional.  
Espera-se uma aplicaÃ§Ã£o com **alta usabilidade**, **acessibilidade bÃ¡sica** e foco na **qualidade do cÃ³digo**  considerando organizaÃ§Ã£o, padronizaÃ§Ã£o, legibilidade e boas prÃ¡ticas de desenvolvimento frontend.

AlÃ©m da fidelidade ao fluxo proposto no mockup, a implementaÃ§Ã£o deve demonstrar domÃ­nio tÃ©cnico na construÃ§Ã£o de componentes reutilizÃ¡veis, tratamento adequado de estados e formulÃ¡rios, e feedback visual eficaz ao usuÃ¡rio.

---

### âœ… Funcionalidades obrigatÃ³rias do frontend

A aplicaÃ§Ã£o deve conter, no mÃ­nimo, as seguintes funcionalidades implementadas:

- **Tabela paginada de produtos**, com:
  - Filtros por **nome**, **faixa de preÃ§o** e **status de desconto**
  - Colunas: **nome**, **descriÃ§Ã£o**, **estoque**, **preÃ§o original** e **preÃ§o com desconto**
  - Destaques visuais para:
    - Produtos **esgotados** (badge ou rÃ³tulo com "Esgotado")
    - Produtos com **desconto ativo**

- **FormulÃ¡rio de cadastro e ediÃ§Ã£o de produto**
  - Com validaÃ§Ãµes de campos e **mensagens de erro claras e acessÃ­veis**
  - Estrutura consistente para inserÃ§Ã£o e atualizaÃ§Ã£o dos dados

- **Modal para aplicaÃ§Ã£o de cupom promocional**
  - Permite informar o cÃ³digo do cupom e aplicÃ¡-lo ao produto selecionado
  - Exibe **feedback imediato** em caso de sucesso ou erro  
    - Ex: cupom **invÃ¡lido**, **expirado**, ou do tipo `oneShot` jÃ¡ utilizado anteriormente

- **BotÃ£o para remoÃ§Ã£o de desconto**
  - DisponÃ­vel na interface do produto
  - Deve refletir a alteraÃ§Ã£o imediatamente na listagem e/ou na visualizaÃ§Ã£o de detalhes

### ðŸ“ **Mockup de Interface no Figma**

Para acessar o mockup de interface do usuÃ¡rio, utilize o link abaixo.

ðŸ”— [Clique aqui para abrir o mockup no Figma](https://www.figma.com/design/s5QC0ms0OqZJFVrVIKjJq3/GrupoA?node-id=1-5&t=lVJlkX7Y6aAMp3LS-1)

![alt text](image.png)

## ðŸ“˜ Requisitos do README.md

O `README.md` deve conter os seguintes tÃ³picos:

1. **Como rodar o projeto**
   - InstruÃ§Ãµes para executar o projeto localmente (por exemplo: `npm install && npm run dev`)
   - Incluir um arquivo `.env.example` com as variÃ¡veis de ambiente necessÃ¡rias para configuraÃ§Ã£o

2. **Estrutura do projeto**
   - Listar as principais pastas do projeto
   - Descrever brevemente a funÃ§Ã£o de cada uma (ex: `/components`, `/pages`, `/services`)

3. **Tecnologias utilizadas**
   - Informar as bibliotecas e frameworks principais utilizados
   - Exemplos esperados: `ReactJS`, `TailwindCSS`, `Axios`, `NestJS`, `Prisma`

---

## ðŸ“© Entrega Parcial Ã© Bem-vinda

Sabemos que o tempo e a complexidade podem variar para cada participante.  
Por isso, **mesmo que nem todas as funcionalidades tenham sido implementadas**, vocÃª pode **encaminhar o desafio mesmo incompleto**.

O objetivo Ã© tambÃ©m avaliar sua **organizaÃ§Ã£o de cÃ³digo**, **clareza tÃ©cnica**, **arquitetura**, e **boas prÃ¡ticas aplicadas**, independentemente do nÃ­vel de conclusÃ£o funcional.

âœ… Ao enviar o que jÃ¡ foi feito, nossa equipe tÃ©cnica irÃ¡ revisar o cÃ³digo com atenÃ§Ã£o e fornecer **feedback construtivo**, destacando os pontos positivos, boas decisÃµes e oportunidades de melhoria.

> ðŸ’¡ **Dica:** Caso envie parcialmente, aproveite o `README.md` para explicar suas escolhas, dificuldades encontradas e o que pretendia implementar a seguir.

---

## ðŸ“¦ Como Enviar Sua Entrega

Para padronizarmos o recebimento e garantir que nada se perca no processo, siga as instruÃ§Ãµes abaixo:

1. **CompactaÃ§Ã£o do Projeto**:
   - Compacte seu projeto em um arquivo `.zip` contendo todo o cÃ³digo-fonte, incluindo o `README.md`.

2. **NomeaÃ§Ã£o do Arquivo**:
   - Nomeie o arquivo com seu nome completo (exemplo: `igor_conde_desafio_fullstack.zip`).

3. **Envio por E-mail**:
   - **Assunto**: Use o seguinte tÃ­tulo padrÃ£o:  
     `[Entrega Desafio TÃ©cnico] Nome Completo â€“ Desenvolvedor(a) Fullstack`  
     Exemplo: `[Entrega Desafio TÃ©cnico] Igor Conde â€“ Desenvolvedor Fullstack`

   - **Corpo do E-mail**:
     - Escreva seu nome completo novamente.
     - Adicione, se desejar, um breve comentÃ¡rio sobre o envio.

   - **Anexo**: Anexe o arquivo `.zip` ao e-mail.

4. **DestinatÃ¡rio**:
   - Envie para: `igor.conde@sistemafiepe.org.br`

---

Boa sorte! ðŸš€
